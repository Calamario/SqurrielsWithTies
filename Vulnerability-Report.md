# Vulnerability Result

## Broken Access Control
### Exposure
We found some instances of Broken Access Control
on some controllers. It didn't contain any Authorize
tags and allowed for non-users to access protions of the 
page. 

This allowed access to non-users seeing order history
of other users through url manipulation.

### Repair
Simply attaching [Authorize] and bringing in the Authorize library 
helped solve this issue. We also went and attached Authorize tags to
View Components just in case as well.
```
[Authorize(Policy = "AdminOnly")]
public class ProductController : Controller
```

### Resource
* [OWASP .NET Security](https://www.owasp.org/index.php/.NET_Security_Cheat_Sheet#ASP.NET_MVC_Guidance)
* [.NET Core Tutorials](https://dotnetcoretutorials.com/2017/12/15/owasp-top-10-asp-net-core-broken-access-control/)

## Cross-Site Scripting (XSS)
### Exposure
XSS can also be injected into styles page and attackers can change
the layout of the page. It can give misleading information or redirect the user
into giving precious information. Our links to style pages also are vulnerable to this
and thus we planned on encoding the HTML.

### Repair
This is done by installing a nuget package to your Visual Studio.
```	
InstallI -Package Microsoft.AspNet.WebUtilities -Pre
```
Then, hrefs on link or anchor tags can be given a query to encode the text.
```
href="/~/CSS/Home.css?query=@System.Net.WebUtility.UrlEncode(Context.Request.Query["query"]
```

### Resource
* [OWASP .NET Security](https://www.owasp.org/index.php/.NET_Security_Cheat_Sheet#ASP.NET_MVC_Guidance)
* [.NET Core Tutorials](https://dotnetcoretutorials.com/2017/10/25/owasp-top-10-asp-net-core-cross-site-scripting-xss/)

